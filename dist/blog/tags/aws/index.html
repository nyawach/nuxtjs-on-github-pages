<!doctype html>
<html data-n-head-ssr lang="ja" data-n-head="lang">
  <head>
    <title data-n-head="true">AWS | hyme</title><meta data-n-head="true" name="fragment" content="!"><meta data-n-head="true" data-hid="charset" charset="utf-8"><meta data-n-head="true" data-hid="viewport" name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta data-n-head="true" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="true" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="hyme"><meta data-n-head="true" data-hid="author" name="author" content="hyme"><meta data-n-head="true" data-hid="description" name="description" content="Webエンジニアの自己紹介サイトです。"><meta data-n-head="true" data-hid="theme-color" name="theme-color" content="#111"><meta data-n-head="true" data-hid="og:type" name="og:type" property="og:type" content="website"><meta data-n-head="true" data-hid="og:title" name="og:title" property="og:title" content="hyme"><meta data-n-head="true" data-hid="og:site_name" name="og:site_name" property="og:site_name" content="hyme"><meta data-n-head="true" data-hid="og:description" name="og:description" property="og:description" content="Webエンジニアの自己紹介サイトです。"><meta data-n-head="true" data-hid="twitter:card" name="twitter:card" property="twitter:card" content="summary_large_image"><meta data-n-head="true" data-hid="twitter:site" name="twitter:site" property="twitter:site" content="@_hyme_"><link data-n-head="true" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="true" rel="icon" type="image/png" sizes="192x192" href="/icon192.png"><link data-n-head="true" rel="apple-touch-icon" sizes="180x180" href="/icon192.png"><link data-n-head="true" rel="manifest" href="/nuxtjs-on-github-pages/_nuxt/manifest.f3f129f8.json"><link data-n-head="true" rel="shortcut icon" href="icon180.png"><script data-n-head="true" src="//www.googletagmanager.com/gtm.js?id=GTM-N72GKLM&l=dataLayer" async></script><base href="/nuxtjs-on-github-pages/"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/1d77e36bfaf4096e9780.js" as="script"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/3f4eac2dce17f6d01105.js" as="script"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/be114672403339f61f60.css" as="style"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/59b2d8ea80011bfd3679.js" as="script"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/cfc4fa4f73bd9b28d00c.css" as="style"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/b393d0689b9c4ca582b8.js" as="script"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/ca2abb884837f33d058f.css" as="style"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/e2933058242d1d7a0ae8.js" as="script"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/64f66d2878d032261053.css" as="style"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/f8599319a527aafa5ebe.js" as="script"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/6eb7bfc61b02947e81fb.css" as="style"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/c38fbb699c8ff3f12853.js" as="script"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/f7125c16520a272d86f8.css" as="style"><link rel="preload" href="/nuxtjs-on-github-pages/_nuxt/e57654431899a8469e5c.js" as="script"><link rel="stylesheet" href="/nuxtjs-on-github-pages/_nuxt/be114672403339f61f60.css"><link rel="stylesheet" href="/nuxtjs-on-github-pages/_nuxt/cfc4fa4f73bd9b28d00c.css"><link rel="stylesheet" href="/nuxtjs-on-github-pages/_nuxt/ca2abb884837f33d058f.css"><link rel="stylesheet" href="/nuxtjs-on-github-pages/_nuxt/64f66d2878d032261053.css"><link rel="stylesheet" href="/nuxtjs-on-github-pages/_nuxt/6eb7bfc61b02947e81fb.css"><link rel="stylesheet" href="/nuxtjs-on-github-pages/_nuxt/f7125c16520a272d86f8.css">
    <script>window.prerenderReady=!1</script>
  </head>
  <body data-n-head="">
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><main class="blog" data-v-a5efaa08><header data-v-75930c71 data-v-a5efaa08><div class="logo" data-v-75930c71><a href="/nuxtjs-on-github-pages/" class="logo__link nuxt-link-active" data-v-75930c71>hyme</a></div><div class="lead" data-v-75930c71>ちょっとなにかある。</div></header><div class="title-box" data-v-a5efaa08><h1 class="title" data-v-a5efaa08>AWS</h1></div><div class="content" data-v-4fb14097 data-v-a5efaa08><ul class="posts" data-v-4fb14097><li class="post-item" data-v-cc1e1478 data-v-4fb14097><a href="/nuxtjs-on-github-pages/blog/posts/cloudfront-s3-gzip/" data-v-cc1e1478><div class="info" data-v-cc1e1478><span class="info__category" data-v-cc1e1478>Web</span><time class="info__created-at" data-v-cc1e1478>2019.02.15</time></div><p class="title" data-v-cc1e1478>CloudFront+S3の静的サイト構成でgzip圧縮データが配信されなかったときに試したこと</p></a></li></ul></div><footer class="footer" data-v-6241211e data-v-a5efaa08><div class="inner" data-v-6241211e><small class="copy" data-v-6241211e>© 2018-2019 hyme</small></div></footer></main></div></div><script>window.__NUXT__=function(e,n,t,s,o,i,a,d,l,r,p,c,y,g){return r.sys={space:{sys:{type:e,linkType:d,id:t}},id:"1RHECfKcNO0OaW280uCOCY",type:s,createdAt:"2018-06-09T13:05:20.243Z",updatedAt:"2018-06-09T13:05:58.402Z",environment:{sys:{id:o,type:e,linkType:i}},revision:2,contentType:{sys:{type:e,linkType:n,id:"category"}},locale:a},r.fields={name:"Web",slug:"web"},{layout:"default",data:[{posts:[{sys:{space:{sys:{type:e,linkType:d,id:t}},id:"Lb0MCBO8CBAuKeQd5aIT1",type:s,createdAt:"2019-02-15T14:35:04.522Z",updatedAt:"2019-02-15T14:47:26.610Z",environment:{sys:{id:o,type:e,linkType:i}},revision:2,contentType:{sys:{type:e,linkType:n,id:"blog"}},locale:a},fields:{title:"CloudFront+S3の静的サイト構成でgzip圧縮データが配信されなかったときに試したこと",slug:"cloudfront-s3-gzip",category:r,tag:[{sys:{space:{sys:{type:e,linkType:d,id:t}},id:p,type:s,createdAt:c,updatedAt:c,environment:{sys:{id:o,type:e,linkType:i}},revision:1,contentType:{sys:{type:e,linkType:n,id:"tag"}},locale:a},fields:{name:"AWS",slug:"aws",category:r}}],description:"AWSでCloudFront+S3の静的サイトの配信をやることはかなり主流になってきていると思います。この構成で、gzip圧縮をやる際に少し手こずったため、記録しておきます。",body:"AWSでCloudFront+S3の静的サイトの配信をやることはかなり主流になってきていると思います。  \nこの構成で、gzip圧縮をやる際に少し手こずったため、記録しておきます。\n\n## サイト構成について\n\nシンプルなS3+CloudFrontの構成です。\n\nS3に関しては、ウェブサイトホスティングの設定を有効にしていました。  \nCloudFrontでは、S3のウェブサイトホスティングのURLをoriginに指定しておく構成です。\n\n## 気づき\n\nCloudFrontのBehaviorの設定には、「Compress Objects Automatically」という項目があります。\n\n> Select whether you want CloudFront to automatically compress content for web requests that include Accept-Encoding: gzip in the request header. CloudFront compresses files of certain types for both Amazon S3 and custom origins.\n>\n> 「Compress Objects Automatically」のinformationより\n\n要約すると、「Accept-Encoding: gzipのヘッダがリクエストに含まれてたら、作れるやつは自動でgzipデータに圧縮するよ」というものです。  \nこれをチェックすれば、自動的にgzip配信が適用されると思い「Yes」にしていました。\n\n![image01](//images.ctfassets.net/xisblufoxlb6/65d91j7YtjfJqv6UXr6E7h/3e2a5bbd200de49f08cfeb97e48e7896/image01.jpg)\n\nですが、CloudFrontで配信されているページで確認してみると、非圧縮のままのデータが送信されていました。\n\n![image00](//images.ctfassets.net/xisblufoxlb6/7B8HjbIjrjNzroMSDuRzrn/47e286e90b485631cd23f7198fbf97ab/image00.jpg)\n\n「gzip圧縮データが配信されていない…」\n\n## 解決方法\n\nCloudFrontのBehaviorの設定項目の「Whitelist Headers」に、「Accept-Encoding」を追加することで、gzip配信が可能になりました。\n\n![image02](//images.ctfassets.net/xisblufoxlb6/2Dof12zemTbqgUsuT0sqbc/3bd0a26da7d74a16eb6b85d841e25be9/image02.jpg)\n\n実際にChromeのDevToolsで確認してみましょう。\n\n![image03](//images.ctfassets.net/xisblufoxlb6/6hc9NVpbI2qxVHMPrmnCU0/05f9381563e8f1fc4c134c6dcb78e705/image03.jpg)\n\n無事gzipが返されていることが確認できました！\n\n## 参考文献\n\n- [圧縮ファイルの供給 - Amazon CloudFront](https://docs.aws.amazon.com/ja_jp/AmazonCloudFront/latest/DeveloperGuide/ServingCompressedFiles.html)"}}],tag:{id:p,slug:"aws",name:"AWS"}}],error:null,state:{auth:!1},serverRendered:!0}}("Link","ContentType","xisblufoxlb6","Entry","master","Environment","ja-JP","Space",0,{},"7JxwCr68jvbBm66u0Ded8h","2019-02-15T14:15:52.388Z")</script><script src="/nuxtjs-on-github-pages/_nuxt/1d77e36bfaf4096e9780.js" defer></script><script src="/nuxtjs-on-github-pages/_nuxt/b393d0689b9c4ca582b8.js" defer></script><script src="/nuxtjs-on-github-pages/_nuxt/e2933058242d1d7a0ae8.js" defer></script><script src="/nuxtjs-on-github-pages/_nuxt/f8599319a527aafa5ebe.js" defer></script><script src="/nuxtjs-on-github-pages/_nuxt/c38fbb699c8ff3f12853.js" defer></script><script src="/nuxtjs-on-github-pages/_nuxt/e57654431899a8469e5c.js" defer></script><script src="/nuxtjs-on-github-pages/_nuxt/3f4eac2dce17f6d01105.js" defer></script><script src="/nuxtjs-on-github-pages/_nuxt/59b2d8ea80011bfd3679.js" defer></script>
  </body>
</html>
